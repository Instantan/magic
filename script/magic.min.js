(()=>{var G=Object.create;var q=Object.defineProperty;var Q=Object.getOwnPropertyDescriptor;var Y=Object.getOwnPropertyNames;var Z=Object.getPrototypeOf,j=Object.prototype.hasOwnProperty;var g=(t,n)=>()=>(n||t((n={exports:{}}).exports,n),n.exports);var N=(t,n,r,s)=>{if(n&&typeof n=="object"||typeof n=="function")for(let c of Y(n))!j.call(t,c)&&c!==r&&q(t,c,{get:()=>n[c],enumerable:!(s=Q(n,c))||s.enumerable});return t};var ee=(t,n,r)=>(r=t!=null?G(Z(t)):{},N(n||!t||!t.__esModule?q(r,"default",{value:t,enumerable:!0}):r,t));var V=g((De,I)=>{m.notEqual=ne;m.notOk=re;m.equal=te;m.ok=m;I.exports=m;function te(t,n,r){m(t==n,r)}function ne(t,n,r){m(t!=n,r)}function re(t,n){m(!t,n)}function m(t,n){if(!t)throw new Error(n||"AssertionError")}});var L=g((Me,x)=>{x.exports=["onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmousemove","onmouseout","onmouseenter","onmouseleave","ontouchcancel","ontouchend","ontouchmove","ontouchstart","ondragstart","ondrag","ondragenter","ondragleave","ondragover","ondrop","ondragend","onkeydown","onkeypress","onkeyup","onunload","onabort","onerror","onresize","onscroll","onselect","onchange","onsubmit","onreset","onfocus","onblur","oninput","onanimationend","onanimationiteration","onanimationstart","oncontextmenu","onfocusin","onfocusout"]});var M=g((Ue,D)=>{var P=L(),ie=P.length,se=1,ce=3,oe=8;D.exports=ae;function ae(t,n){var r=t.nodeType,s=t.nodeName;r===se&&ue(t,n),(r===ce||r===oe)&&n.nodeValue!==t.nodeValue&&(n.nodeValue=t.nodeValue),s==="INPUT"?me(t,n):s==="OPTION"?fe(t,n):s==="TEXTAREA"&&pe(t,n),le(t,n)}function ue(t,n){for(var r=n.attributes,s=t.attributes,c=null,a=null,l=null,u=null,f=null,A=s.length-1;A>=0;--A)f=s[A],u=f.name,c=f.namespaceURI,a=f.value,c?(u=f.localName||u,l=n.getAttributeNS(c,u),l!==a&&n.setAttributeNS(c,u,a)):n.hasAttribute(u)?(l=n.getAttribute(u),l!==a&&(a==="null"||a==="undefined"?n.removeAttribute(u):n.setAttribute(u,a))):n.setAttribute(u,a);for(var S=r.length-1;S>=0;--S)f=r[S],f.specified!==!1&&(u=f.name,c=f.namespaceURI,c?(u=f.localName||u,t.hasAttributeNS(c,u)||n.removeAttributeNS(c,u)):t.hasAttributeNS(null,u)||n.removeAttribute(u))}function le(t,n){for(var r=0;r<ie;r++){var s=P[r];t[s]?n[s]=t[s]:n[s]&&(n[s]=void 0)}}function fe(t,n){R(t,n,"selected")}function me(t,n){var r=t.value,s=n.value;R(t,n,"checked"),R(t,n,"disabled"),t.indeterminate!==n.indeterminate&&(n.indeterminate=t.indeterminate),n.type!=="file"&&(r!==s&&(n.setAttribute("value",r),n.value=r),r==="null"&&(n.value="",n.removeAttribute("value")),t.hasAttributeNS(null,"value")?n.type==="range"&&(n.value=r):n.removeAttribute("value"))}function pe(t,n){var r=t.value;if(r!==n.value&&(n.value=r),n.firstChild&&n.firstChild.nodeValue!==r){if(r===""&&n.firstChild.nodeValue===n.placeholder)return;n.firstChild.nodeValue=r}}function R(t,n,r){t[r]!==n[r]&&(n[r]=t[r],t[r]?n.setAttribute(r,""):n.removeAttribute(r))}});var W=g(($e,H)=>{var T=V(),he=M(),de=3;H.exports=ge;function ge(t,n,r){return T.equal(typeof t,"object","nanomorph: oldTree should be an object"),T.equal(typeof n,"object","nanomorph: newTree should be an object"),r&&r.childrenOnly?(B(n,t),t):(T.notEqual(n.nodeType,11,"nanomorph: newTree should have one root node (which is not a DocumentFragment)"),v(n,t))}function v(t,n){return n?t?t.isSameNode&&t.isSameNode(n)?n:t.tagName!==n.tagName||U(t)!==U(n)?t:(he(t,n),B(t,n),n):null:t}function U(t){return t.dataset?t.dataset.nanomorphComponentId:void 0}function B(t,n){for(var r,s,c,a,l=0,u=0;r=n.childNodes[u],s=t.childNodes[u-l],!(!r&&!s);u++)if(!s)n.removeChild(r),u--;else if(!r)n.appendChild(s),l++;else if($(s,r))c=v(s,r),c!==r&&(n.replaceChild(c,r),l++);else{a=null;for(var f=u;f<n.childNodes.length;f++)if($(n.childNodes[f],s)){a=n.childNodes[f];break}a?(c=v(s,a),c!==a&&l++,n.insertBefore(c,r)):!s.id&&!r.id?(c=v(s,r),c!==r&&(n.replaceChild(c,r),l++)):(n.insertBefore(s,r),l++)}}function $(t,n){return t.id?t.id===n.id:t.isSameNode?t.isSameNode(n):t.tagName!==n.tagName?!1:t.type===de?t.nodeValue===n.nodeValue:!1}});var b=ee(W());window.magic={templates:{},refs:{},didRenderRoot:!1,socket:null,baseProps:["metaKey","ctrlKey","shiftKey"],keyboardProps:["key","content"],themeColor:()=>{let t=document.querySelector('meta[name="theme-color"]');return t?t.attributes.getNamedItem("content").value:"rgb(59,130,246)"}};var o=window.magic;function w(t=""){X(),h("connecting");let n=o.socket;if(typeof t!="string"||t===""){let r=new URL(location.host+location.pathname);r.searchParams=new URLSearchParams(location.search),t=r.toString()}o.socket=new WebSocket((window.location.protocol==="https:"?"wss://":"ws://")+t),o.socket.onopen=()=>{n&&n.close(),o.templates={},o.refs={},o.didRenderRoot=!1},o.socket.onmessage=r=>{Oe(),h("connected"),ve(JSON.parse(r.data))},o.socket.onclose=r=>{o.socket&&r.srcElement.url!==o.socket.url||(X(),h("disconnected"),setTimeout(w,1e3))},o.socket.onerror=r=>{console.error("Error: ",r,"Closing socket"),o.socket.close()}}function ve(t){let n=new Set;t.forEach(r=>{if(r.length===2&&typeof r[0]=="number")o.templates[r[0]]=r[1],Se(r[0]);else if(r.length===2&&typeof r[0]=="string"){let s=r[0];if(we(s,r[1]),!o.didRenderRoot)return;n.add(s)}else Ve(r)}),n.forEach(Re),o.didRenderRoot||(d(document),(0,b.default)(document,h("connected",O(_())),{childrenOnly:!0}),d(document),o.didRenderRoot=!0),be()}function y(t){return t&&t.length===2&&!isNaN(t[1])}function ke(t){return t&&Array.isArray(t)&&t.length>0&&y(t[0])}function _(){return E(o.refs[0]["#"])}function be(){let t=o.refs,n=new Set(Object.keys(t));F(n,t,"0"),n.forEach(r=>delete t[r])}function F(t,n,r){t.delete(r);let s=n[r];if(s)for(let c in s){let a=s[c];if(Array.isArray(a)){if(y(a))F(t,n,a[0]);else if(y(a[0]))for(let l=0;l<a.length;l++)F(t,n,a[l][0])}}}function E(t){return ye(`${t[0]}:${t[1]}`,o.templates[t[1]],o.refs[t[0]])}function ye(t,n,r){return Ae(n,s=>{switch(s){case"magic:live":return Ee();case"magic-id":return s+`="${t}"`}if(r===void 0||r[s]===void 0||r[s]===null)return"";let c=r[s];if(y(c))return E(c);if(ke(c)){let a="";for(let l=0;l<c.length;l++)a+=E(c[l]);return a}return c})}function Ee(){return"<script>"+document.head.children[0].innerHTML+"<\/script>"}function Ae(t,n){return t.replace(/~.+?~/g,r=>n(r.slice(1,-1)))}function O(t){if(t.toLowerCase().trim().indexOf("<!doctype")===0){let s=document.implementation.createHTMLDocument("");return s.documentElement.innerHTML=t,s}else if("content"in k("template")){let s=k("template");return s.innerHTML=t,s.content}let n=document.createDocumentFragment(),r=k("body");for(r.innerHTML=t,i=0;0<r.childNodes.length;)n.appendChild(r.childNodes[i]);return n}function Se(t){o.templates[t]=o.templates[t].replace(/<\w*(\s|>|\/>)/m,n=>{let r=" ~magic-id~ ";return n.endsWith("/>")?n.slice(0,-1)+r+"/>":n.endsWith(">")?n.slice(0,-1)+r+">":n+r})}function Re(t){if(t===magic.refs[0]["#"][0]){(0,b.default)(document,d(h("connected",O(_()))),{childrenOnly:!0});return}document.querySelectorAll(`[magic-id^="${t}"]`).forEach(n=>{(0,b.default)(n,d(O(E(n.attributes.getNamedItem("magic-id").value.split(":"))).children[0]))})}function d(t){Ce(t);let n=t.attributes;switch(t.nodeName){case"TEXTAREA":case"INPUT":t.isSameNode=qe}if(n)for(let r=0;r<n.length;r++)n[r].name.startsWith("magic:")&&Te(t,n[r]);if(t.children)for(let r=0;r<t.children.length;r++)d(t.children[r]);return t}function Te(t,n){let r=n.name.slice(6),s=n.value,c=o.baseProps,a=o.keyboardProps;switch(r){case"click":t.onclick=p(r,[...c],s);return;case"focus":t.onfocus=p(r,[...c],s);return;case"change":t.onchange=p(r,[...c,...a],s);return;case"keydown":t.onkeydown=p(r,[...c,...a],s);return;case"keypress":t.onkeypress=p(r,[...c,...a],s);return;case"keyup":t.onkeyup=p(r,[...c,...a],s);return;case"submit":t.onsubmit=p(r,[...c,"form"],s,J);return;case"dblclick":t.ondblclick=p(r,[...c],s);return;case"patch":t.onclick=Ie;case"static":t.isSameNode=l=>{let u=l.attributes.getNamedItem("magic:static");return!!(u&&u.value===s)};return}}function Ce(t){t.onclick=t.onfocus=t.onchange=t.onkeydown=t.onkeypress=t.onkeyup=t.onsubmit=t.ondblclick=null}function p(t,n,r,s){return t="m:"+t,c=>{if(o.socket&&(console.log(c),o.socket.send(JSON.stringify({k:t,t:Number(K(c.target)),p:Object.assign(Fe(c,n),{value:r})}))),typeof s=="function")return s(c)}}function Fe(t,n,r){let s={},c=n.length;for(;c--;){let a=n[c]==="form"?Object.fromEntries(new FormData(t.srcElement).entries()):n[c]==="content"?t.value===void 0?t.target.value:t.value:t[n[c]];a!==void 0&&(s[n[c]]=a)}return s}function X(){if(o.topbar)return;let t=l=>{let u=k("div");return u.style.cssText=l,u},n=(l,u)=>l.appendChild(u),r=o.themeColor(),s=t("position:fixed;overflow:hidden;top:0;left:0;width:100%"),c=t(`background-color:${r};position:absolute;bottom:0;top:0;width:50%`);n(s,t(`background-color:${r};height:.2rem;width:100%;opacity:0.4`)),n(s,c);let a=setTimeout(()=>{n(document.body,s),c.animate([{left:"-50%"},{left:"100%"}],{duration:800,iterations:1/0})},120);s.destroy=()=>{clearInterval(a),s.remove()},o.topbar=s}function Oe(){o.topbar&&(o.topbar.destroy(),o.topbar=null)}function we(t,n){if(o.refs[t]===void 0){o.refs[t]=n;return}Object.assign(o.refs[t],n)}function K(t){if(t&&t.attributes){let n=t.attributes.getNamedItem("magic-id");if(n!==null)return n.value.split(":",1)[0]}return t&&t.parentNode?K(t.parentNode):o.refs[0]["#"][0]}function qe(t){let n=this;return t.prevValue===void 0||t.prevValue!==n.value?t.prevValue=n.value:n.value=t.value,!1}function Ie(t){let n=t.srcElement.attributes.getNamedItem("href").value+"";return z(n),J(t)}function J(t){return t.preventDefault?t.preventDefault():t.stopPropagation&&t.stopPropagation(),!1}function z(t){let n=t.startsWith("/")?location.host+t:t;w(n),history.pushState({},"",t)}function h(t,n=document){if(n.children.length===0)return;let r=n.children[0],s="magic-"+t;if(!r.classList.contains(s))return["connected","connecting","disconnected"].forEach(c=>r.classList.remove("magic-"+c)),r.classList.add(s),n}function Ve(t){if(t.k.startsWith("m:"))switch(t.k=t.k.slice(2),t.k){case"navigate":o.socket&&(o.socket.onclose=void 0),z(t.p);return;case"reset":case"click":case"blur":case"submit":C(t.p,t.t,t.k);return;case"animate":C(t.p.ids,t.t,t.k,t.p.args.keyframes,t.p.args.options?t.p.args.options:t.p.args.duration);return;case"scrollIntoView":C(t.p.ids,t.t,t.k,t.p.args.options?t.p.args.options:t.p.args.alignToTop);return;case"openFullscreen":xe();return;case"closeFullscreen":Le();return;case"disconnect":o.socket&&(o.socket.onclose=void 0,o.socket.close(),h("disconnected"));return;case"updateUrl":history.pushState({},"",t.p);return}let n=new CustomEvent(t.k,{target:t.t,detail:t.p});document.querySelectorAll(`[magic-id^="${t.t}"]`).forEach(r=>r.dispatchEvent(n)),window.dispatchEvent(n)}function k(t){return document.createElement(t)}function C(t=[],n=null,r="",...s){let c=a=>{try{a&&a[r]&&a[r](...s)}catch(l){console.error(l)}};t.forEach(a=>c(document.getElementById(a))),t.length===0&&document.querySelectorAll(`[magic-id^="${e.t}"]`).forEach(c)}function xe(){document.requestFullscreen?document.requestFullscreen():elem.webkitRequestFullscreen?document.webkitRequestFullscreen():elem.msRequestFullscreen&&document.msRequestFullscreen()}function Le(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()}document.addEventListener("DOMContentLoaded",w);})();
